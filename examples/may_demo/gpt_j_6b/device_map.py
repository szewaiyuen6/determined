device_map = {
    "transformer.wte": 0,
    "transformer.drop": 0,
    "transformer.h.0": 0,
    "transformer.h.1": 0,
    "transformer.h.2": 0,
    "transformer.h.3": 0,
    "transformer.h.4": 0,
    "transformer.h.5": 0,
    "transformer.h.6": 0,
    "transformer.h.7": 0,
    "transformer.h.8": 0,
    "transformer.h.9": 0,
    "transformer.h.10": 0,
    "transformer.h.11": "cpu",
    "transformer.h.12": "cpu",
    "transformer.h.13": "cpu",
    "transformer.h.14": "cpu",
    "transformer.h.15": "cpu",
    "transformer.h.16": "cpu",
    "transformer.h.17": "cpu",
    "transformer.h.18": "cpu",
    "transformer.h.19": "cpu",
    "transformer.h.20": "cpu",
    "transformer.h.21": "cpu",
    "transformer.h.22": "cpu",
    "transformer.h.23": "cpu",
    "transformer.h.24": "cpu",
    "transformer.h.25": "cpu",
    "transformer.h.26": "cpu",
    "transformer.h.27": "cpu",
    "transformer.ln_f": "cpu",
    "lm_head": "cpu",
}
